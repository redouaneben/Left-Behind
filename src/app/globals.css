@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --background: #050505;
  --foreground: #ffffffe6; /* blanc 90% */
  --accent: #FFD700;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html,
body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: var(--background);
  color: var(--foreground);
  font-family: "Montserrat", "Inter", system-ui, -apple-system, sans-serif;
}

/* ── Hover popup — élastique, titre complet, jamais tronqué ──── */
.mapboxgl-popup-content {
  font-family: "Montserrat", "Inter", system-ui, -apple-system, sans-serif;
  background: rgba(8, 10, 16, 0.9) !important;
  backdrop-filter: blur(18px) saturate(1.5);
  -webkit-backdrop-filter: blur(18px) saturate(1.5);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px !important;
  padding: 12px 16px !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.55);
  width: auto !important;
  max-width: 350px !important;
  pointer-events: none;
  white-space: normal !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
}
/* Titre et date — jamais de troncature */
.mapboxgl-popup-content * {
  text-overflow: clip !important;
  overflow: visible !important;
  white-space: normal !important;
}

.mapboxgl-popup-tip {
  border-top-color: rgba(8, 10, 16, 0.9) !important;
}

/* ── Masquer l'attribution en mode immersif ──────────────────── */
.mapboxgl-ctrl-attrib {
  opacity: 0.3;
  transition: opacity 0.3s;
}
.mapboxgl-ctrl-attrib:hover {
  opacity: 1;
}

/* ── Bouton de langue — hover or + scale ──────────────────────── */
.lang-btn:hover {
  color: #FFD700 !important;
  border-color: rgba(255, 215, 0, 0.4) !important;
  transform: scale(1.05);
}

/* ═══════════════════════════════════════════════════════════════════
   TRANSITIONS Landing → Globe
   ═══════════════════════════════════════════════════════════════════ */
.landing-exit {
  animation: landingExit 1400ms ease-in-out forwards;
}
@keyframes landingExit {
  0%   { opacity: 1; }
  100% { opacity: 0; }
}

.globe-enter {
  animation: globeEnter 1600ms cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}
@keyframes globeEnter {
  0%   { opacity: 0; transform: scale(1.15); }
  100% { opacity: 1; transform: scale(1); }
}

.tabbar-enter {
  animation: tabbarEnter 800ms ease-out 800ms both;
}
@keyframes tabbarEnter {
  0%   { opacity: 0; transform: translateY(24px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* ── Bouton Landing — hover doré ──────────────────────────────── */
.landing-cta-btn {
  transition: all 300ms ease;
}
.landing-cta-btn:hover {
  color: #FFD700 !important;
  border-color: rgba(255, 215, 0, 0.5) !important;
  background: rgba(255, 215, 0, 0.06) !important;
  box-shadow: none !important;
}

/* ── Animation sortie formulaire CreateFragment ──────────────── */
@keyframes formExit {
  0%   { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px); }
  100% { opacity: 0; transform: translateY(20px) scale(0.97); filter: blur(4px); }
}
.form-exit {
  animation: formExit 300ms cubic-bezier(0.4, 0, 1, 1) forwards;
  pointer-events: none;
}
@keyframes formOverlayExit {
  0%   { opacity: 1; }
  100% { opacity: 0; }
}
.form-overlay-exit {
  animation: formOverlayExit 400ms ease forwards;
  pointer-events: none;
}

/* ── Couronne rotative autour du point sélectionné ────────── */
/* Centrage par offsets négatifs explicites (parent = 0×0)     */
@keyframes crownSpin {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
@keyframes highlightPulse {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50%      { transform: scale(1.4); opacity: 0.15; }
}
.highlight-crown {
  position: absolute;
  /* 70×70 → offset = -35 pour centrer sur l'ancre (0,0) */
  top: -35px; left: -35px;
  width: 70px; height: 70px;
  border: 2px dashed #FFD700; /* couleur par défaut, overridée inline */
  border-radius: 50%;
  transform-origin: center;
  animation: crownSpin 4s linear infinite;
  pointer-events: none;
}
.highlight-pulse {
  position: absolute;
  /* 90×90 → offset = -45 pour centrer sur l'ancre (0,0) */
  top: -45px; left: -45px;
  width: 90px; height: 90px;
  border-radius: 50%;
  /* couleur par défaut, overridée inline selon le mode */
  background: radial-gradient(circle, rgba(255,215,0,0.35) 0%, transparent 70%);
  transform-origin: center;
  animation: highlightPulse 1.2s ease-in-out infinite;
  pointer-events: none;
}

/* ── StoryCard body — scrollbar luxe (invisible → visible au hover) ── */

/* Or (fragments) ─────────────── */
.story-scroll-gold::-webkit-scrollbar { width: 3px; }
.story-scroll-gold::-webkit-scrollbar-track { background: transparent; }
.story-scroll-gold::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0);
  border-radius: 99px;
  transition: background 0.3s;
}
.story-scroll-gold:hover::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0.3);
}
.story-scroll-gold:hover::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 215, 0, 0.5);
}
.story-scroll-gold {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}
.story-scroll-gold:hover {
  scrollbar-color: rgba(255, 215, 0, 0.3) transparent;
}

/* Violet (history) ───────────── */
.story-scroll-violet::-webkit-scrollbar { width: 3px; }
.story-scroll-violet::-webkit-scrollbar-track { background: transparent; }
.story-scroll-violet::-webkit-scrollbar-thumb {
  background: rgba(187, 134, 252, 0);
  border-radius: 99px;
  transition: background 0.3s;
}
.story-scroll-violet:hover::-webkit-scrollbar-thumb {
  background: rgba(187, 134, 252, 0.3);
}
.story-scroll-violet:hover::-webkit-scrollbar-thumb:hover {
  background: rgba(187, 134, 252, 0.5);
}
.story-scroll-violet {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}
.story-scroll-violet:hover {
  scrollbar-color: rgba(187, 134, 252, 0.3) transparent;
}

/* ── Explore Panel — scrollbar luxe identique à StoryCard ──── */

/* Gold (Fragments) */
.explore-scroll-gold::-webkit-scrollbar { width: 3px; }
.explore-scroll-gold::-webkit-scrollbar-track { background: transparent; }
.explore-scroll-gold::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0);
  border-radius: 99px;
  transition: background 0.3s;
}
.explore-scroll-gold:hover::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0.3);
}
.explore-scroll-gold:hover::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 215, 0, 0.5);
}
.explore-scroll-gold {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}
.explore-scroll-gold:hover {
  scrollbar-color: rgba(255, 215, 0, 0.3) transparent;
}

/* Violet (History) */
.explore-scroll-violet::-webkit-scrollbar { width: 3px; }
.explore-scroll-violet::-webkit-scrollbar-track { background: transparent; }
.explore-scroll-violet::-webkit-scrollbar-thumb {
  background: rgba(187, 134, 252, 0);
  border-radius: 99px;
  transition: background 0.3s;
}
.explore-scroll-violet:hover::-webkit-scrollbar-thumb {
  background: rgba(187, 134, 252, 0.3);
}
.explore-scroll-violet:hover::-webkit-scrollbar-thumb:hover {
  background: rgba(187, 134, 252, 0.5);
}
.explore-scroll-violet {
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}
.explore-scroll-violet:hover {
  scrollbar-color: rgba(187, 134, 252, 0.3) transparent;
}

/* Dégradé de fondu en bas — suggère du contenu à découvrir */
.scroll-fade-bottom {
  -webkit-mask-image: linear-gradient(to bottom, black 0%, black 82%, transparent 100%);
  mask-image: linear-gradient(to bottom, black 0%, black 82%, transparent 100%);
}

@keyframes exploreCardIn {
  0%   { opacity: 0; transform: translateY(8px); }
  100% { opacity: 1; transform: translateY(0); }
}
.explore-card {
  animation: exploreCardIn 0.3s ease-out both;
}

/* Transition fluide entre Vue A (filtres) et Vue B (résultats) */
@keyframes exploreViewIn {
  0%   { opacity: 0; transform: translateX(12px); }
  100% { opacity: 1; transform: translateX(0); }
}
.explore-view-in {
  animation: exploreViewIn 0.25s ease-out both;
}

/* ── StoryCard slide-in (premium fade + scale + slide) ──── */
@keyframes storySlideIn {
  0%   { opacity: 0; transform: translateY(-12px) scale(0.96); filter: blur(4px); }
  60%  { opacity: 1; filter: blur(0px); }
  100% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px); }
}
@keyframes storySlideOut {
  0%   { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px); }
  100% { opacity: 0; transform: translateY(12px) scale(0.96); filter: blur(4px); }
}

/* ── Quiz — Animations résultat ────────────────────────────── */
@keyframes quizResultPop {
  0%   { transform: scale(0.3); opacity: 0; }
  50%  { transform: scale(1.15); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes quizConfetti {
  0%   { opacity: 1; transform: translateY(0) scale(0.5) rotate(0deg); }
  60%  { opacity: 1; }
  100% { opacity: 0; transform: translateY(60px) scale(1.2) rotate(180deg); }
}

@keyframes quizToastIn {
  0%   { opacity: 0; transform: translateY(-12px) scale(0.95); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes spin {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
